<head>
  <link rel="stylesheet" href="index.css" />
</head>

<body class="bg-gray-700">
  <table class="text-xl table-fixed w-screen h-screen text-center">
    <tr class="border-b-5">
      <th class="bg-red-500 h-20 w-20">
        <button
          class="bg-red-500 hover:cursor-pointer hover:bg-red-700 text-white font-bold py-4 px-4"
          onclick="reset()"
        >
          <img src="src/reset.svg" class="w-5" />
        </button>
      </th>
      <th class="bg-blue-300 w-35">MultiPlayer</th>
      <th class="bg-blue-100 text-3xl" contenteditable="true">P1</th>
      <th class="bg-blue-200 text-3xl" contenteditable="true">P2</th>
      <th class="bg-blue-100 text-3xl" contenteditable="true">P3</th>
      <th class="bg-blue-200 text-3xl" contenteditable="true">P4</th>
      <th class="bg-blue-100 text-3xl" contenteditable="true">P5</th>
    </tr>
    <tr>
      <th class="bg-pink-400" rowspan="3">
        <div
          class="bg-pink-400 [writing-mode:sideways-lr] h-[100%] w-[100%] flex justify-center items-center"
        >
          <p>Points on Cards</p>
        </div>
      </th>
      <th class="bg-pink-300">Birds</th>
      <td class="bg-pink-100 text-4xl" player="1" contenteditable="true">0</td>
      <td class="bg-pink-200 text-4xl" player="2" contenteditable="true">0</td>
      <td class="bg-pink-100 text-4xl" player="3" contenteditable="true">0</td>
      <td class="bg-pink-200 text-4xl" player="4" contenteditable="true">0</td>
      <td class="bg-pink-100 text-4xl" player="5" contenteditable="true">0</td>
    </tr>
    <tr>
      <th class="bg-pink-300">Bonus Cards</th>
      <td class="bg-pink-100 text-4xl" player="1" contenteditable="true">0</td>
      <td class="bg-pink-200 text-4xl" player="2" contenteditable="true">0</td>
      <td class="bg-pink-100 text-4xl" player="3" contenteditable="true">0</td>
      <td class="bg-pink-200 text-4xl" player="4" contenteditable="true">0</td>
      <td class="bg-pink-100 text-4xl" player="5" contenteditable="true">0</td>
    </tr>
    <tr>
      <th class="bg-pink-300">End-of-Round Goals</th>
      <td class="bg-pink-100 text-4xl" player="1" contenteditable="true">0</td>
      <td class="bg-pink-200 text-4xl" player="2" contenteditable="true">0</td>
      <td class="bg-pink-100 text-4xl" player="3" contenteditable="true">0</td>
      <td class="bg-pink-200 text-4xl" player="4" contenteditable="true">0</td>
      <td class="bg-pink-100 text-4xl" player="5" contenteditable="true">0</td>
    </tr>
    <tr class="border-t-3">
      <th class="bg-green-400" rowspan="3">
        <div
          class="[writing-mode:sideways-lr] bg-green-400 h-[100%] w-[100%] flex justify-center items-center"
        >
          One Point Each
        </div>
      </th>
      <th class="bg-green-300">Eggs</th>
      <td class="bg-green-100 text-4xl" player="1" contenteditable="true">0</td>
      <td class="bg-green-200 text-4xl" player="2" contenteditable="true">0</td>
      <td class="bg-green-100 text-4xl" player="3" contenteditable="true">0</td>
      <td class="bg-green-200 text-4xl" player="4" contenteditable="true">0</td>
      <td class="bg-green-100 text-4xl" player="5" contenteditable="true">0</td>
    </tr>
    <tr>
      <th class="bg-green-300">Cached Food</th>
      <td class="bg-green-100 text-4xl" player="1" contenteditable="true">0</td>
      <td class="bg-green-200 text-4xl" player="2" contenteditable="true">0</td>
      <td class="bg-green-100 text-4xl" player="3" contenteditable="true">0</td>
      <td class="bg-green-200 text-4xl" player="4" contenteditable="true">0</td>
      <td class="bg-green-100 text-4xl" player="5" contenteditable="true">0</td>
    </tr>
    <tr>
      <th class="bg-green-300">Tucked Cards</th>
      <td class="bg-green-100 text-4xl" player="1" contenteditable="true">0</td>
      <td class="bg-green-200 text-4xl" player="2" contenteditable="true">0</td>
      <td class="bg-green-100 text-4xl" player="3" contenteditable="true">0</td>
      <td class="bg-green-200 text-4xl" player="4" contenteditable="true">0</td>
      <td class="bg-green-100 text-4xl" player="5" contenteditable="true">0</td>
    </tr>
    <tr class="border-t-5">
      <th colspan="2" class="bg-yellow-200">Total</th>
      <td class="bg-yellow-50 text-4xl" id="total-p1">0</td>
      <td class="bg-yellow-100 text-4xl" id="total-p2">0</td>
      <td class="bg-yellow-50 text-4xl" id="total-p3">0</td>
      <td class="bg-yellow-100 text-4xl" id="total-p4">0</td>
      <td class="bg-yellow-50 text-4xl" id="total-p5">0</td>
    </tr>
  </table>

  <script>
    function reset() {
      document.querySelectorAll('td[contenteditable="true"]').forEach((td) => {
        td.textContent = 0;
      });
      [1, 2, 3, 4, 5].forEach((i) => doTotal(i));
    }
    function handleChange(td) {
      if (!Number.isInteger(Number(td.textContent.trim()))) td.textContent = "";
    }
    function handleBlur(td) {
      if (td.textContent == "") td.textContent = "0";
      doTotal(td.getAttribute("player"));
    }
    function doTotal(player) {
      totalPt = 0;
      document.querySelectorAll(`td[player="${player}"]`).forEach((td) => {
        console.log("afafaf");
        totalPt += Number(td.textContent.trim());
      });
      document.getElementById(`total-p${player}`).textContent = totalPt;
    }

    document.querySelectorAll('td[contenteditable="true"]').forEach((td) => {
      td.addEventListener("input", () => {
        handleChange(td);
      });
      td.addEventListener("blur", () => {
        handleBlur(td);
      });
      td.addEventListener("focus", () => {
        if (td.textContent == "0") td.textContent = "";
      });
    });
  </script>
</body>
